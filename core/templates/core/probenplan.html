{% load static %}
{% load sass_tags %}
{% load tz %}

<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/milligram/1.3.0/milligram.css">
  <link href="{% sass_src 'core/custom.scss' %}" rel="stylesheet" type="text/css"/>
  <title>Probenplan des LJO Hamburg (Stand {% now "j.n.Y" %})</title>
</head>
<body>
<header class="header">
  <div class="title">
    <h1>Probenplan des LJO Hamburg</h1>
    <div>Stand vom {% now "j.n.Y" %}</div>
  </div>
  <img src="https://ljo-hamburg.de/wp-content/uploads/2019/06/ljo-logo-png.png" alt="LJO-Logo" width="240">
</header>
<section class="control">
  <form method="get" action="{% url 'probenplan' %}">
    <input class="button" type="submit" value="Filter anwenden">
    <input type="checkbox" id="all" name="all" {% if all_events %}checked{% endif %}>
    <label class="label-inline" for="all">Vergangene Termine Zeigen</label>
    <input type="checkbox" id="bw" name="bw" {% if black_and_white %}checked{% endif %}>
    <label class="label-inline" for="bw">Keine Farben anzeigen</label>
    {% if all_events %}
    {% elif from_date or to_date %}
      <span class="fill"></span>
      <span>Zeige Termine{% if from_date %} ab dem {{ from_date|date:'j.m.Y' }}{% endif %}{% if to_date %} bis zum
        {{ to_date|date:'j.m.Y' }}{% endif %}</span>
    {% endif %}
  </form>
</section>
<hr/>
<table class="table">
  <thead>
  <tr>
    <th class="date-cell" scope="col">
      <div>Datum</div>
    </th>
    <th class="time-cell" scope="col">
      <div>Uhrzeit</div>
    </th>
    <th class="event-cell" scope="col">
      <div>Titel/Ort</div>
    </th>
    <th class="description-cell" scope="col">
      <div>Anmerkungen</div>
    </th>
  </tr>
  </thead>
  <tbody>
  {% for day_events in events %}
    {% ifchanged %}
      <tr class="year-row">
        <th colspan="4"><h4>Termine in {{ day_events.day|date:'Y' }}</h4></th>
      </tr>
    {% endifchanged %}
    {% for event in day_events.events %}
      <tr class="{% if forloop.first %}line {% endif %}{{ event.css_classes|join:' ' }}{% if black_and_white %} bw{% endif %}">
        {% if forloop.first %}
          <th rowspan="{{ day_events.events|length }}" scope="row" class="date-cell">
            <div class="event-date">
              {{ day_events.day|date:'j. M' }}
            </div>
          </th>
        {% endif %}
        {% if event.all_day %}
          <td class="time-cell">
            <div class="event-time"><i>ganztägig</i></div>
          </td>
        {% else %}
          <td class="time-cell">
            <div class="event-time">{{ event.begin|time:'H:i' }} – {{ event.end|date:'H:i' }}</div>
          </td>
        {% endif %}
        <td valign="middle" class="event-cell">
          <div class="event">
            <div class="title">{{ event.title }}</div>
            <small class="location">
              {{ event.location|safe }}
            </small>
          </div>
        </td>
        <td class="description-cell">
          <div class="event-description">{{ event.description|safe }}</div>
        </td>
      </tr>
    {% endfor %}
  {% endfor %}
  </tbody>
</table>
</body>
</html>